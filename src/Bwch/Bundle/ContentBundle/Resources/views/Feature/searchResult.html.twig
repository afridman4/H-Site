{% extends '::base.html.twig' %}

{% block title %}
    {{ parent() }} - Search plans result
{% endblock %}

{% block body %}

<div class="class_div___layer
            class_div___layer-Main"
     id="id_div___layer-Main">

    {% include 'header.html.twig' %}

    <div class="class_div___element-Main"
         id="id_div___element-Main">

    <div class="class_div___element-Main--main">
        <div class="class_div___element-Main--main--columns">
            <div class="class___float__right
								class_div___element-Main--main--columns--column
								class_div___element-Main--main--columns--column__right">
                {# ======== Banner section START ======== #}
                <div>
                    {{ render(controller('BwchContentBundle:Banner:fiveBanners')) }}
                </div>
                {# ======== Banner section END ======== #}
            </div>
                <div class="class_div___element-Main--main--columns--column
								class_div___element-Main--main--columns--column__center">

                <div style="padding:0 10px 16px 0;">

                <table class="class___width__100">
                    <tr>
                        <th><h1 style="margin:0 0 12px 0;">{{ htype.display_name }}</h1></th>
                        <td style="width:585px;">
                            <div style="float:left;font-family:HelveticaNeue-Light;font-size:18px;line-height:45px;">
                                All results - <b style="font-family:HelveticaNeue-Bold;font-weight:normal;">{{ plans|length }}</b>, min price - <b style="font-family:HelveticaNeue-Bold;font-weight:normal;">${{ minPrice }}</b>, max price - <b style="font-family:HelveticaNeue-Bold;font-weight:normal;">${{ maxPrice }}</b>
                            </div>
                            <div class="class_div___element-CustomButtons-style__2"
                                 style="float:right;position:relative;margin:7px 0 0;">
                                <a href="javascript:void(0)" style="position:relative;z-index:100;width:auto;font-size:13px;line-height:18px;" onclick="jQuery(this).next().toggle()">Sort by:
                                    <i style="padding:0 10px 0 0;font-family:HelveticaNeue-Bold;font-style:normal;background:url(/images/shared/arrow/7x4/color__000000.png) right center no-repeat;">Provider</i> </a>
                                <div style="display:none;position:absolute;top:30px;z-index:99;width:100%;background-color:#f7f7f7;">
                                    <div style="padding:2px 0 0;border:1px solid #e5e5e5;border-top:none;" id="sortingContainer">
                                        <ul>
                                            <li onmouseover="this.style.backgroundColor='#dfdfdf'" onmouseout="this.style.backgroundColor='#f7f7f7'" style="padding:2px 5px;cursor:pointer;" onclick="jQuery(this).closest('div').parent('div').hide();" data-sort="provider"><span>Provider</span></li>
                                            <li onmouseover="this.style.backgroundColor='#dfdfdf'" onmouseout="this.style.backgroundColor='#f7f7f7'" style="padding:2px 5px;cursor:pointer;" onclick="jQuery(this).closest('div').parent('div').hide();" data-sort="price"><span>Price</span></li>
                                            <li onmouseover="this.style.backgroundColor='#dfdfdf'" onmouseout="this.style.backgroundColor='#f7f7f7'" style="padding:2px 5px;cursor:pointer;" onclick="jQuery(this).closest('div').parent('div').hide();" data-sort="rating"><span>Rating</span></li>
                                            <li onmouseover="this.style.backgroundColor='#dfdfdf'" onmouseout="this.style.backgroundColor='#f7f7f7'" style="padding:2px 5px;cursor:pointer;" onclick="jQuery(this).closest('div').parent('div').hide();" data-sort="popularity"><span>Popularity</span></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="class_div___element-Separator-type__clear_both"></div>
                        </td>
                    </tr>
                </table>

                <table class="class___width__100">
                    <tr>
                        <th style="width:225px;background:url(/images/shared/separator/3x1/grey_gradient.png) right top repeat-y;">
                            <div class="class_div___element-SearchCriteria">
                                <h2>You search criteria</h2>

                                <div class="class_div___component-ScrollableContainer
                                            class_div___component-ScrollableContainer-vertical_scrollbar_style__w6_grey
                                            class_div___component-ScrollableContainer__HostingPlanFeatures"
                                     id="id_div___component-ScrollableContainer__search_criteria">

                                    {# ======== Search Form section START ======== #}
                                    <div class="class_div___element-ScrollableContainer">
                                        <div>
                                            {{ render(controller('BwchContentBundle:Feature:searchForm', {
                                            'currentRoute': currentRoute,
                                            'parameters': parameters,
                                            'htype': htype.name
                                            })) }}
                                        </div>
                                    </div>
                                    {# ======== Search Form section END ======== #}
                                    {{ include('BwchContentBundle:Common:scrollbar.html.twig') }}
                                </div>
                                <div style="margin:10px 10px 0 0;">
                                    <table class="class___component-Button
                                                class_table___component-Button
                                                class___width__100
                                                class___component-Button__h40_green1
                                                class___component-Button-dimensions__h40
                                                class___component-Button-style__green1"
                                           id="searchButton">
                                        <tr>
                                            <td>
                                                <i><b><s><u>New Search</u></s></b></i>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </th>
                        <td>
                                <div class="class_div___element-SearchResults"  style="padding:0 0 0 10px">
                                <div class="class___element-Frame-style__1" style="padding:10px 5px;font-size:13px;">
                                    <table class="class___width__100">
                                        <tr>
                                            <td style="width:20px;vertical-align:middle;"><input type="checkbox" onclick="$.F_SelectAllSearchResults(this)"/></td>
                                            <td style="width:120px;vertical-align:middle;">Company</td>
                                            <td style="vertical-align:middle;">Short Description</td>
                                            <td style="width:86px;vertical-align:middle;">Providers Price</td>
                                            <td style="width:100px"></td>
                                        </tr>
                                    </table>
                                </div>

                                <div style="padding:2px 2px 2px 0;border:1px solid #e5e5e5;border-top:none;">
                                    <div class="class_div___component-ScrollableContainer
                                                class_div___component-ScrollableContainer-vertical_scrollbar_style__w6_grey
                                                class_div___component-ScrollableContainer__search_results"
                                         id="id_div___component-ScrollableContainer__search_results">
                                        <div class="class_div___element-ScrollableContainer">
                                            <div>
                                        {% if plans is empty %}
                                                Sorry, there is no plans to meet your criteria. Change the conditions and try again, please.
                                        {% else %}
                                                <form action="{{ path('bwch_compare_plans') }}" method="post" id="comparePlansForm">
                                                    <input type="hidden" name="htype" value="{{ htype.name }}">
                                                    <div id="resultContainer">
                                                {# ======== Plans search results section START ======== #}
                                                    {% for plan in plans %}
                                                        <div data-provider="{{ plan.provider }}"
                                                             data-price="{{ plan.advprice }}"
                                                             data-rating="{% if plan.generalrating is not defined %}{{ -loop.index0 }}{% else %}{{ plan.generalrating }}{% endif %}"
                                                             data-popularity="{% if plan.generalrating is not defined %}{{ loop.index0 }}{% else %}{{ plan.generalrating }}{% endif %}"
                                                             style="padding:10px 5px;{% if loop.index < 10 %}border-bottom:1px solid #e5e5e5;{% endif %}{% if loop.index > pageSize %}display:none;{% endif %}"
                                                             class="resultItem"
                                                             id="resultItem{{ loop.index }}">
                                                            <table class="class___width__100">
                                                                <tr>
                                                                    <td style="width:20px;"><input type="checkbox" name="selectedPlans[]" value="{{ plan.provider ~ '_' ~ plan.planname }}"/></td>
                                                                    <td style="width:120px;font-family:helveticaNeue-Bold;font-size:15px;">
                                                                        <span data-type="provider">{{ plan.provider }}</span>
                                                                        {% if plan.providerDetails.generalrating is not defined %}
                                                                            {%  set generalRating = 0 %}
                                                                        {% else %}
                                                                            {% set generalRating = plan.providerDetails.generalrating %}
                                                                        {% endif %}
                                                                        {{ include('BwchContentBundle:Review:asterisks.html.twig') }}
                                                                    </td>
                                                                    <td style="font-size:13px;">
                                                                        <b style="font-family:HelveticaNeue-Bold;">{{ plan.planname }}</b> {% if plan.short_description is not defined %}  {{ plan.description[0:100]}} {% else %} {{ plan.short_description }}{% endif %}
                                                                        {% set generalRating = plan.generalrating|default(0) %}
                                                                        {{ include('BwchContentBundle:Review:asterisks.html.twig') }}
                                                                    </td>
                                                                    <td style="width:86px;font-family:HelveticaNeue-Bold;font-size:14px;text-align:center;">
                                                                        <div style="text-align:right;line-height:32px;"><span data-type="price">{{ plan.advprice }}</span></div>
                                                                        <div class="class_div___element-CustomButtons-style__2">
                                                                            <a href="{{ path('bwch_plan_calculation', {'provider': plan.provider, 'planname': plan.planname}) }}" style="font-family:HelveticaNeue-Bold;font-size:10px;"><b>Estimate cost</b></a>
                                                                        </div>
                                                                    </td>
                                                                    <td style="width:100px;">
                                                                        <table style="margin:0 auto;"
                                                                               class="class___component-Button
                                                                                    class_table___component-Button
                                                                                    class___component-Button__h32_green1
                                                                                    class___component-Button-dimensions__h32
                                                                                    class___component-Button-style__green1"
                                                                               onclick="location.href='{{ path('bwch_plan_details', {'provider': plan.provider, 'planname': plan.planname}) }}'">
                                                                            <tr>
                                                                                <td>
                                                                                    <i><b><s><u>Select</u></s></b></i>
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    {% endfor %}
                                                {# ======== Plans search results section END ======== #}
                                                    </div>
                                                </form>
                                        {% endif %}
                                            </div>
                                        </div>
                                        {{ include('BwchContentBundle:Common:scrollbar.html.twig') }}

                                    </div>
                                </div>

                                {% if pagesCount > 1 %}
                                <table class="class_table___component-Paginator
                                            class_table___component-Paginator-type__ordered
                                            class___margin__10px_auto_0"
                                        id="id_table___component-Paginator__search_results">
                                    <tr>
                                        <th class="class_th___component-Paginator-control__show_previous_page class_div___element-Paginator--control__show_previous_page">
                                            <b><i></i></b>
                                        </th>
                                        <td>
                                            <div class="class_div___component-Paginator--navigation_items">
                                                <table>
                                                    <tr class="class_div___element-Paginator--navigation_items">
                                                        {% for page in 1..pagesCount %}
                                                            <td class="class_td___component-Paginator--navigation_items--item
									                                class___element-pagination-index__{{ loop.index }}">
                                                                <b{% if not loop.index0 %} class="class___element-status__selected"{% endif %}>{{ loop.index }}</b>
                                                            </td>
                                                        {% endfor %}
                                                    </tr>
                                                </table>
                                            </div>
                                        </td>
                                        <th class="class_th___component-Paginator-control__show_next_page class_div___element-Paginator--control__show_next_page">
                                            <b><i></i></b>
                                        </th>
                                    </tr>
                                </table>
                                {% endif %}
                                    <script>
                                        (new BWCH_Paginator).Init({
                                            pagesCount: {{ pagesCount }},
                                            pageSize: {{ pageSize }},
                                            currentPage: 1
                                        });

                                    </script>


                                    <div style="border-bottom:1px solid #e5e5e5;">
                                    <div class="class_div___element-CustomButtons-style__2"
                                         style="float:left;margin:10px 0;">
                                        <a href="#" id="compareSeleted" style="width:auto;font-family:HelveticaNeue-Bold;font-size:13px;line-height:18px;">Compare selected</a>
                                    </div>
                                    <div class="class_div___element-Separator-type__clear_both"></div>
                                </div>
                                {# ======== Reviews section START ======== #}
                                {{ render(controller('BwchContentBundle:Review:recentReviews', {
                                'max': 3, 'currentRoute': currentRoute
                                })) }}
                                {# ======== Reviews section END ======== #}

                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="class_div___element-Separator-type__clear_both"></div>
    </div>
            </div>
        </div>

    {% include 'footer.html.twig' %}
</div>
{% endblock %}
